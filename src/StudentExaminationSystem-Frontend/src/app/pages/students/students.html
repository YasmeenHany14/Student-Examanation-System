<div class="flex flex-col h-full p-6">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold">Students</h2>
  </div>

  @if(loading()) {
    <app-spinner/>
  }

  @if(isError()) {
    <app-no-data-to-show/>
  }

  @if (students() && students().length !== 0) {
    <p-toolbar>
      <ng-template #start>
        <div class="flex flex-col md:flex-row gap-2">
          <p-iconfield iconPosition="left">
            <p-inputicon class="pi pi-search" />
            <input
              type="text"
              pInputText
              placeholder="Search By Name"
              [(ngModel)]="searchQuery"
            />
          </p-iconfield>
          <p-button
            icon="pi pi-search"
            label="Search"
            severity="contrast"
            (click)="onSearchStudent()">
          </p-button>
        </div>
      </ng-template>
    </p-toolbar>
    <p-table [value]="students()" [paginator]="true" [rows]="paginationInfo().PageSize" [totalRecords]="totalRecords()"
             (onLazyLoad)="onLazyLoad($event)" [lazy]="true" [loading]="loading()"
             (onSort)="customSort($event)" [customSort]="true">
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="name">
            <div class="flex items-center gap-2">
              Name
              <p-sortIcon field="name" />
            </div>
          </th>
          <th>Active Status</th>
          <th style="width: 80px;">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-student>
        <tr>
          <td>{{ student.name }}</td>
          <td>
            <p-toggleswitch [ngModel]="student.isActive" (onChange)="onToggleStatus(student)" />
          </td>
          <td>
            <p-button
              icon="pi pi-eye"
              class="p-button-rounded p-button-sm mr-2"
              [text]="true"
              severity="info"
              size="small"
              (click)="onViewStudentDetails(student.id)"
              pTooltip="View Details"
              tooltipPosition="top">
            </p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  }

  <!-- Student Details Dialog -->
  <app-student-details-dialog
    [selectedStudentId]="selectedStudentId()"
    [visible]="visible()"
    (close)="onCloseDialog()">
  </app-student-details-dialog>
</div>
